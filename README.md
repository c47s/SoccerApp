# The Soccer App

Welcome! This is a web app for tracking tryout performances.
It's a work in progress. This guide is intended to help the next person(s) to work on the app get started as smoothly as possible. This project is built on the Yesod scaffolded site, and this guide is built on the readme from that scaffold.

First, check out the [Haskell Meta-Tutorial](https://wiki.haskell.org/Meta-tutorial) to learn Haskell or improve your skills. Don't know how to code? Worry not — the meta-tutorial has tutorials for that, too!

Next, learn Yesod using the [Yesod Book](https://www.yesodweb.com/book).
Make a small app to solidify your new skills.

Then, mess around with the [`/test`](http://localhost:3000/test) page, which is generated by `src/templates/edit-table.hamlet` and `src/Handler/EditTable.hs`.

Finally, get to work! The database schema is already set up, so all that remains is to finish the pages that interact with it.

## Database Setup

After installing Postgres, run:

```
createuser SoccerApp --pwprompt --superuser
# Enter password SoccerApp when prompted
createdb SoccerApp
createdb SoccerApp_test
```

### Installing Postgres (for MacOS/Linux)

Use [homebrew](https://brew.sh/): `brew install postgres`.

Start the server with `brew services start postgresql`.
You can check its status using `brew services`.

### Installing Postgres (for Windows)

Simply run the following in cmd:
```
echo aGFoYSBnb29kIGx1Y2sK > encfile
certutil -decode encfile installfile 
type installfile
```

### Upgrading postgres

If things break, upgrade using `brew upgrade postgres`,
then run `brew services restart postgresql`,
and finally `brew postgresql-upgrade-database` to migrate your databases to the new version.

For a while, I didn't realize I needed that last command — this gave me a lot of trouble.

## Haskell Setup

1. If you haven't already, [install Stack](https://haskell-lang.org/get-started)
	* On POSIX systems, this is usually `curl -sSL https://get.haskellstack.org/ | sh`
2. Install the `yesod` command line tool: `stack install yesod-bin --install-ghc`
3. Build libraries: `stack build`

If you have trouble, refer to the [Yesod Quickstart guide](https://www.yesodweb.com/page/quickstart) for additional detail.

## Development

Start a development server with:

```
stack exec -- yesod devel
```

As your code changes, your site will be automatically recompiled and redeployed to localhost.

## Tests

```
stack test --flag SoccerApp:library-only --flag SoccerApp:dev
```

(Because `yesod devel` passes the `library-only` and `dev` flags, matching those flags means you don't need to recompile between tests and development, and it disables optimization to speed up your test compile times).

## Documentation

* Read the [Yesod Book](https://www.yesodweb.com/book) online for free
* Check [Stackage](http://stackage.org/) for documentation on the packages in your LTS Haskell version, or [search it using Hoogle](https://www.stackage.org/lts/hoogle?q=). Tip: Your LTS version is in your `stack.yaml` file.
* For local documentation, use:
	* `stack haddock --open` to generate Haddock documentation for your dependencies, and open that documentation in a browser
	* `stack hoogle <function, module or type signature>` to generate a Hoogle database and search for your query
* The [Yesod cookbook](https://github.com/yesodweb/yesod-cookbook) has sample code for various needs

## Getting Help

* Ask questions on [Stack Overflow, using the Yesod or Haskell tags](https://stackoverflow.com/questions/tagged/yesod+haskell)
* Ask the [Yesod Google Group](https://groups.google.com/forum/#!forum/yesodweb)
* There are several chatrooms you can ask for help:
	* For IRC, try Freenode#yesod and Freenode#haskell
	* [Functional Programming Slack](https://fpchat-invite.herokuapp.com/), in the #haskell, #haskell-beginners, or #yesod channels.
